(this.webpackJsonp=this.webpackJsonp||[]).push([[38],{3965:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringBase",(function(){return h})),n.d(t,"KeyringBaseMock",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),s=n.n(o),u=n(9),a=n.n(u),c=n(14),f=n.n(c),d=n(7),l=n.n(d);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var h=function(e){a()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=i()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),s()(n)}(n(1607).VaultContext),y=function(e){a()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}return s()(n)}(h)},3967:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringSoftwareBase",(function(){return w}));var r=n(4),i=n.n(r),o=n(3),s=n.n(o),u=n(2),a=n.n(u),c=n(6),f=n.n(c),d=n(9),l=n.n(d),p=n(14),h=n.n(p),y=n(7),v=n.n(y),g=n(18),E=n(22);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var w=function(e){l()(n,e);var t=A(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=a()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new E.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.default.engine.info("signTransaction",this.networkId,e),m(m({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=a()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new E.OneKeyInternalError("Software signing requires a password.");var o=yield this.getDbAccount(),s=Object.values(yield this.getSigners(r,[o.address])),u=i()(s,1)[0];return g.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,u)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},f()(n)}(n(3965).KeyringBase)},3972:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"VaultBaseChainOnly",(function(){return k})),n.d(t,"VaultBase",(function(){return R}));var r=n(207),i=n.n(r),o=n(3),s=n.n(o),u=n(61),a=n.n(u),c=n(2),f=n.n(c),d=n(6),l=n.n(d),p=n(9),h=n.n(p),y=n(14),v=n.n(y),g=n(7),E=n.n(g),I=n(21),m=n.n(I),A=n(175),w=n.n(A),_=n(12),b=n(18),T=n(25),P=n(66),N=n(22),x=n(191),L=n(965),S=n(52),D=n(1607);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}if(T.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var k=function(e){h()(n,e);var t=B(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=f()((function*(){var e=(yield this.getNetwork()).impl;a()(L.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new N.NotImplemented},r.getEthersProvider=function(){var e=f()((function*(){throw new N.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=f()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(){var e=f()((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=f()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||!n)throw new N.InvalidAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=f()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=f()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new N.InvalidTokenAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=f()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=f()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=f()((function*(e,t,n){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:C({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n,r){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=f()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.fetchBalanceDetails=function(){var e=f()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=f()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=f()((function*(){var e=yield this.getNetwork();return Object(x.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=f()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=f()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=f()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=f()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=f()((function*(){throw new N.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=f()((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),r.getTxWaitingSeconds=function(){var e=f()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=f()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),l()(n)}(D.VaultContext),R=function(t){h()(r,t);var n=B(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).uuid=w.a.v4().toString(),e}var o=r.prototype;return o.init=function(){var e=f()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=f()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=f()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=f()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?C(C({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(C(C({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=f()((function*(e,t){b.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return b.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),C(C({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=f()((function*(){throw new N.NotImplemented}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=f()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:i()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=f()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=yield this.getDbAccount(),o=i.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),n,r)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=f()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=f()((function*(e){var t,n,r,i,o=e.action,s=e.accountAddress;(o.direction=S.IDecodedTxDirection.OTHER,o.type===S.IDecodedTxActionType.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:s}));o.type===S.IDecodedTxActionType.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:s}));return o}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=f()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=a()(r)?e.nonce:new m.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var s=e.actions[o];yield this.fixActionDirection({action:s,accountAddress:i})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var c=e.outputActions[u];yield this.fixActionDirection({action:c,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=f()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=f()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,s=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!s)throw new Error("buildHistoryTx txid not found");var u=yield this.getAccountAddress();n.txid=s||n.txid,n.owner=u,i&&(n.signer=u),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var a=C(C({id:this.networkId+"_"+s+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return a=yield this.fixHistoryTx(a),Promise.resolve(a)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=f()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=f()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?S.IDecodedTxDirection.SELF:t&&t===r?S.IDecodedTxDirection.OUT:n&&n===r?S.IDecodedTxDirection.IN:S.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=f()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield P.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),s=yield P.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(a()(o)?0:o+1,i);if(Number.isNaN(u)&&(u=i),u>i)for(var c=i;c<u;c+=1)if(!s.includes(c)){u=c;break}if(u<i&&(u=i),u-i>=_.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new N.PendingQueueTooLong(_.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,n){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=f()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=f()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),o.getAllUsedAddress=function(){var e=f()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),l()(r)}(k)}.call(this,n(27).Buffer)},3975:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHardwareBase",(function(){return v}));var r=n(2),i=n.n(r),o=n(6),s=n.n(o),u=n(9),a=n.n(u),c=n(14),f=n.n(c),d=n(7),l=n.n(d),p=n(442),h=n(167);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var v=function(t){a()(r,t);var n=y(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.HardwareSDK}));return function(){return t.apply(this,arguments)}}(),o.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},s()(r)}(n(3965).KeyringBase)}.call(this,n(59))},3976:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringHdBase",(function(){return m}));var r=n(3),i=n.n(r),o=n(2),s=n.n(o),u=n(6),a=n.n(u),c=n(9),f=n.n(c),d=n(14),l=n.n(d),p=n(7),h=n.n(p),y=n(627),v=n(22);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var m=function(e){f()(n,e);var t=I(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=s()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new v.OneKeyInternalError("Unable to get credential.");var s=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(y.batchGetPrivateKeys)(s,o,e,i,r).reduce((function(e,t){var n;return E(E({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(n)}(n(3967).KeyringSoftwareBase)},3977:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringImportedBase",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),s=n.n(o),u=n(9),a=n.n(u),c=n(14),f=n.n(c),d=n(7),l=n.n(d),p=n(22);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var y=function(e){a()(n,e);var t=h(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.NotImplemented("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.OneKeyInternalError("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},s()(n)}(n(3967).KeyringSoftwareBase)},3978:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringWatchingBase",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),s=n.n(o),u=n(9),a=n.n(u),c=n(14),f=n.n(c),d=n(7),l=n.n(d),p=n(22);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var y=function(e){a()(n,e);var t=h(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},s()(n)}(n(3965).KeyringBase)},3987:function(e){e.exports=JSON.parse('{"COMPRESSED_TYPE_INVALID":"compressed should be a boolean","EC_PRIVATE_KEY_TYPE_INVALID":"private key should be a Buffer","EC_PRIVATE_KEY_LENGTH_INVALID":"private key length is invalid","EC_PRIVATE_KEY_RANGE_INVALID":"private key range is invalid","EC_PRIVATE_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting private key is invalid","EC_PRIVATE_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PRIVATE_KEY_EXPORT_DER_FAIL":"couldn\'t export to DER format","EC_PRIVATE_KEY_IMPORT_DER_FAIL":"couldn\'t import from DER format","EC_PUBLIC_KEYS_TYPE_INVALID":"public keys should be an Array","EC_PUBLIC_KEYS_LENGTH_INVALID":"public keys Array should have at least 1 element","EC_PUBLIC_KEY_TYPE_INVALID":"public key should be a Buffer","EC_PUBLIC_KEY_LENGTH_INVALID":"public key length is invalid","EC_PUBLIC_KEY_PARSE_FAIL":"the public key could not be parsed or is invalid","EC_PUBLIC_KEY_CREATE_FAIL":"private was invalid, try again","EC_PUBLIC_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting public key is invalid","EC_PUBLIC_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PUBLIC_KEY_COMBINE_FAIL":"the sum of the public keys is not valid","ECDH_FAIL":"scalar was invalid (zero or overflow)","ECDSA_SIGNATURE_TYPE_INVALID":"signature should be a Buffer","ECDSA_SIGNATURE_LENGTH_INVALID":"signature length is invalid","ECDSA_SIGNATURE_PARSE_FAIL":"couldn\'t parse signature","ECDSA_SIGNATURE_PARSE_DER_FAIL":"couldn\'t parse DER signature","ECDSA_SIGNATURE_SERIALIZE_DER_FAIL":"couldn\'t serialize signature to DER format","ECDSA_SIGN_FAIL":"nonce generation function failed or private key is invalid","ECDSA_RECOVER_FAIL":"couldn\'t recover public key from signature","MSG32_TYPE_INVALID":"message should be a Buffer","MSG32_LENGTH_INVALID":"message length is invalid","OPTIONS_TYPE_INVALID":"options should be an Object","OPTIONS_DATA_TYPE_INVALID":"options.data should be a Buffer","OPTIONS_DATA_LENGTH_INVALID":"options.data length is invalid","OPTIONS_NONCEFN_TYPE_INVALID":"options.noncefn should be a Function","RECOVERY_ID_TYPE_INVALID":"recovery should be a Number","RECOVERY_ID_VALUE_INVALID":"recovery should have value between -1 and 4","TWEAK_TYPE_INVALID":"tweak should be a Buffer","TWEAK_LENGTH_INVALID":"tweak length is invalid"}')},3992:function(e,t,n){var r=n(317).Buffer;e.exports={check:function(e){if(e.length<8)return!1;if(e.length>72)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-2)return!1;if(2!==e[2])return!1;var t=e[3];if(0===t)return!1;if(5+t>=e.length)return!1;if(2!==e[4+t])return!1;var n=e[5+t];return 0!==n&&(6+t+n===e.length&&(!(128&e[4])&&(!(t>1&&0===e[4]&&!(128&e[5]))&&(!(128&e[t+6])&&!(n>1&&0===e[t+6]&&!(128&e[t+7]))))))},decode:function(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(48!==e[0])throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(2!==e[2])throw new Error("Expected DER integer");var t=e[3];if(0===t)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(2!==e[4+t])throw new Error("Expected DER integer (2)");var n=e[5+t];if(0===n)throw new Error("S length is zero");if(6+t+n!==e.length)throw new Error("S length is invalid");if(128&e[4])throw new Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw new Error("R value excessively padded");if(128&e[t+6])throw new Error("S value is negative");if(n>1&&0===e[t+6]&&!(128&e[t+7]))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},encode:function(e,t){var n=e.length,i=t.length;if(0===n)throw new Error("R length is zero");if(0===i)throw new Error("S length is zero");if(n>33)throw new Error("R length is too long");if(i>33)throw new Error("S length is too long");if(128&e[0])throw new Error("R value is negative");if(128&t[0])throw new Error("S value is negative");if(n>1&&0===e[0]&&!(128&e[1]))throw new Error("R value excessively padded");if(i>1&&0===t[0]&&!(128&t[1]))throw new Error("S value excessively padded");var o=r.allocUnsafe(6+n+i);return o[0]=48,o[1]=o.length-2,o[2]=2,o[3]=e.length,e.copy(o,4),o[4+n]=2,o[5+n]=t.length,t.copy(o,6+n),o}}},3994:function(e,t,n){"use strict";e.exports=n(3995)(n(3998))},3995:function(e,t,n){"use strict";var r=n(3996),i=n(3997),o=n(3987);function s(e,t){return void 0===e?t:(r.isBoolean(e,o.COMPRESSED_TYPE_INVALID),e)}e.exports=function(e){return{privateKeyVerify:function(t){return r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,n){r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),n=s(n,!0);var u=e.privateKeyExport(t,n);return i.privateKeyExport(t,u,n)},privateKeyImport:function(t){if(r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(o.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,n){return r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),r.isBuffer(n,o.TWEAK_TYPE_INVALID),r.isBufferLength(n,32,o.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,n)},privateKeyTweakMul:function(t,n){return r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),r.isBuffer(n,o.TWEAK_TYPE_INVALID),r.isBufferLength(n,32,o.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,n)},publicKeyCreate:function(t,n){return r.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),n=s(n,!0),e.publicKeyCreate(t,n)},publicKeyConvert:function(t,n){return r.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),n=s(n,!0),e.publicKeyConvert(t,n)},publicKeyVerify:function(t){return r.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,n,i){return r.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),r.isBuffer(n,o.TWEAK_TYPE_INVALID),r.isBufferLength(n,32,o.TWEAK_LENGTH_INVALID),i=s(i,!0),e.publicKeyTweakAdd(t,n,i)},publicKeyTweakMul:function(t,n,i){return r.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),r.isBuffer(n,o.TWEAK_TYPE_INVALID),r.isBufferLength(n,32,o.TWEAK_LENGTH_INVALID),i=s(i,!0),e.publicKeyTweakMul(t,n,i)},publicKeyCombine:function(t,n){r.isArray(t,o.EC_PUBLIC_KEYS_TYPE_INVALID),r.isLengthGTZero(t,o.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)r.isBuffer(t[i],o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(t[i],33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID);return n=s(n,!0),e.publicKeyCombine(t,n)},signatureNormalize:function(t){return r.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),r.isBufferLength(t,64,o.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){r.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),r.isBufferLength(t,64,o.ECDSA_SIGNATURE_LENGTH_INVALID);var n=e.signatureExport(t);return i.signatureExport(n)},signatureImport:function(t){r.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),r.isLengthGTZero(t,o.ECDSA_SIGNATURE_LENGTH_INVALID);var n=i.signatureImport(t);if(n)return e.signatureImport(n);throw new Error(o.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){r.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),r.isLengthGTZero(t,o.ECDSA_SIGNATURE_LENGTH_INVALID);var n=i.signatureImportLax(t);if(n)return e.signatureImport(n);throw new Error(o.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,n,i){r.isBuffer(t,o.MSG32_TYPE_INVALID),r.isBufferLength(t,32,o.MSG32_LENGTH_INVALID),r.isBuffer(n,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(n,32,o.EC_PRIVATE_KEY_LENGTH_INVALID);var s=null,u=null;return void 0!==i&&(r.isObject(i,o.OPTIONS_TYPE_INVALID),void 0!==i.data&&(r.isBuffer(i.data,o.OPTIONS_DATA_TYPE_INVALID),r.isBufferLength(i.data,32,o.OPTIONS_DATA_LENGTH_INVALID),s=i.data),void 0!==i.noncefn&&(r.isFunction(i.noncefn,o.OPTIONS_NONCEFN_TYPE_INVALID),u=i.noncefn)),e.sign(t,n,u,s)},verify:function(t,n,i){return r.isBuffer(t,o.MSG32_TYPE_INVALID),r.isBufferLength(t,32,o.MSG32_LENGTH_INVALID),r.isBuffer(n,o.ECDSA_SIGNATURE_TYPE_INVALID),r.isBufferLength(n,64,o.ECDSA_SIGNATURE_LENGTH_INVALID),r.isBuffer(i,o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(i,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,n,i)},recover:function(t,n,i,u){return r.isBuffer(t,o.MSG32_TYPE_INVALID),r.isBufferLength(t,32,o.MSG32_LENGTH_INVALID),r.isBuffer(n,o.ECDSA_SIGNATURE_TYPE_INVALID),r.isBufferLength(n,64,o.ECDSA_SIGNATURE_LENGTH_INVALID),r.isNumber(i,o.RECOVERY_ID_TYPE_INVALID),r.isNumberInInterval(i,-1,4,o.RECOVERY_ID_VALUE_INVALID),u=s(u,!0),e.recover(t,n,i,u)},ecdh:function(t,n){return r.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),r.isBuffer(n,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(n,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,n)},ecdhUnsafe:function(t,n,i){return r.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),r.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),r.isBuffer(n,o.EC_PRIVATE_KEY_TYPE_INVALID),r.isBufferLength(n,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),i=s(i,!0),e.ecdhUnsafe(t,n,i)}}}},3996:function(e,t,n){"use strict";(function(e){var n=Object.prototype.toString;t.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},t.isBoolean=function(e,t){if("[object Boolean]"!==n.call(e))throw TypeError(t)},t.isBuffer=function(t,n){if(!e.isBuffer(t))throw TypeError(n)},t.isFunction=function(e,t){if("[object Function]"!==n.call(e))throw TypeError(t)},t.isNumber=function(e,t){if("[object Number]"!==n.call(e))throw TypeError(t)},t.isObject=function(e,t){if("[object Object]"!==n.call(e))throw TypeError(t)},t.isBufferLength=function(e,t,n){if(e.length!==t)throw RangeError(n)},t.isBufferLength2=function(e,t,n,r){if(e.length!==t&&e.length!==n)throw RangeError(r)},t.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},t.isNumberInInterval=function(e,t,n,r){if(e<=t||e>=n)throw RangeError(r)}}).call(this,n(27).Buffer)},3997:function(e,t,n){"use strict";var r=n(317).Buffer,i=n(3992),o=r.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s=r.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t.privateKeyExport=function(e,t,n){var i=r.from(n?o:s);return e.copy(i,n?8:9),t.copy(i,n?181:214),i},t.privateKeyImport=function(e){var t=e.length,n=0;if(!(t<n+1||48!==e[n])&&!(t<(n+=1)+1)&&128&e[n]){var r=127&e[n];if(n+=1,!(r<1||r>2)&&!(t<n+r)){var i=e[n+r-1]|(r>1?e[n+r-2]<<8:0);if(!(t<(n+=r)+i)&&!(t<n+3||2!==e[n]||1!==e[n+1]||1!==e[n+2])&&!(t<(n+=3)+2||4!==e[n]||e[n+1]>32||t<n+2+e[n+1]))return e.slice(n+2,n+2+e[n+1])}}},t.signatureExport=function(e){for(var t=r.concat([r.from([0]),e.r]),n=33,o=0;n>1&&0===t[o]&&!(128&t[o+1]);--n,++o);for(var s=r.concat([r.from([0]),e.s]),u=33,a=0;u>1&&0===s[a]&&!(128&s[a+1]);--u,++a);return i.encode(t.slice(o),s.slice(a))},t.signatureImport=function(e){var t=r.alloc(32,0),n=r.alloc(32,0);try{var o=i.decode(e);if(33===o.r.length&&0===o.r[0]&&(o.r=o.r.slice(1)),o.r.length>32)throw new Error("R length is too long");if(33===o.s.length&&0===o.s[0]&&(o.s=o.s.slice(1)),o.s.length>32)throw new Error("S length is too long")}catch(s){return}return o.r.copy(t,32-o.r.length),o.s.copy(n,32-o.s.length),{r:t,s:n}},t.signatureImportLax=function(e){var t=r.alloc(32,0),n=r.alloc(32,0),i=e.length,o=0;if(48===e[o++]){var s=e[o++];if(!(128&s&&(o+=s-128)>i)&&2===e[o++]){var u=e[o++];if(128&u){if(o+(s=u-128)>i)return;for(;s>0&&0===e[o];o+=1,s-=1);for(u=0;s>0;o+=1,s-=1)u=(u<<8)+e[o]}if(!(u>i-o)){var a=o;if(o+=u,2===e[o++]){var c=e[o++];if(128&c){if(o+(s=c-128)>i)return;for(;s>0&&0===e[o];o+=1,s-=1);for(c=0;s>0;o+=1,s-=1)c=(c<<8)+e[o]}if(!(c>i-o)){var f=o;for(o+=c;u>0&&0===e[a];u-=1,a+=1);if(!(u>32)){var d=e.slice(a,a+u);for(d.copy(t,32-d.length);c>0&&0===e[f];c-=1,f+=1);if(!(c>32)){var l=e.slice(f,f+c);return l.copy(n,32-l.length),{r:t,s:n}}}}}}}}}},3998:function(e,t,n){"use strict";var r=n(317).Buffer,i=n(764),o=n(174),s=n(532).ec,u=n(3987),a=new s("secp256k1"),c=a.curve;function f(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var n=new o(t);if(n.cmp(c.p)>=0)return null;var r=(n=n.toRed(c.red)).redSqr().redIMul(n).redIAdd(c.b).redSqrt();return 3===e!==r.isOdd()&&(r=r.redNeg()),a.keyPair({pub:{x:n,y:r}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,n){var r=new o(t),i=new o(n);if(r.cmp(c.p)>=0||i.cmp(c.p)>=0)return null;if(r=r.toRed(c.red),i=i.toRed(c.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var s=r.redSqr().redIMul(r);return i.redSqr().redISub(s.redIAdd(c.b)).isZero()?a.keyPair({pub:{x:r,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}t.privateKeyVerify=function(e){var t=new o(e);return t.cmp(c.n)<0&&!t.isZero()},t.privateKeyExport=function(e,t){var n=new o(e);if(n.cmp(c.n)>=0||n.isZero())throw new Error(u.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return r.from(a.keyFromPrivate(e).getPublic(t,!0))},t.privateKeyNegate=function(e){var t=new o(e);return t.isZero()?r.alloc(32):c.n.sub(t).umod(c.n).toArrayLike(r,"be",32)},t.privateKeyModInverse=function(e){var t=new o(e);if(t.cmp(c.n)>=0||t.isZero())throw new Error(u.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(c.n).toArrayLike(r,"be",32)},t.privateKeyTweakAdd=function(e,t){var n=new o(t);if(n.cmp(c.n)>=0)throw new Error(u.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(n.iadd(new o(e)),n.cmp(c.n)>=0&&n.isub(c.n),n.isZero())throw new Error(u.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return n.toArrayLike(r,"be",32)},t.privateKeyTweakMul=function(e,t){var n=new o(t);if(n.cmp(c.n)>=0||n.isZero())throw new Error(u.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return n.imul(new o(e)),n.cmp(c.n)&&(n=n.umod(c.n)),n.toArrayLike(r,"be",32)},t.publicKeyCreate=function(e,t){var n=new o(e);if(n.cmp(c.n)>=0||n.isZero())throw new Error(u.EC_PUBLIC_KEY_CREATE_FAIL);return r.from(a.keyFromPrivate(e).getPublic(t,!0))},t.publicKeyConvert=function(e,t){var n=f(e);if(null===n)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);return r.from(n.getPublic(t,!0))},t.publicKeyVerify=function(e){return null!==f(e)},t.publicKeyTweakAdd=function(e,t,n){var i=f(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new o(t)).cmp(c.n)>=0)throw new Error(u.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var s=c.g.mul(t).add(i.pub);if(s.isInfinity())throw new Error(u.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return r.from(s.encode(!0,n))},t.publicKeyTweakMul=function(e,t,n){var i=f(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new o(t)).cmp(c.n)>=0||t.isZero())throw new Error(u.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return r.from(i.pub.mul(t).encode(!0,n))},t.publicKeyCombine=function(e,t){for(var n=new Array(e.length),i=0;i<e.length;++i)if(n[i]=f(e[i]),null===n[i])throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);for(var o=n[0].pub,s=1;s<n.length;++s)o=o.add(n[s].pub);if(o.isInfinity())throw new Error(u.EC_PUBLIC_KEY_COMBINE_FAIL);return r.from(o.encode(!0,t))},t.signatureNormalize=function(e){var t=new o(e.slice(0,32)),n=new o(e.slice(32,64));if(t.cmp(c.n)>=0||n.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);var i=r.from(e);return 1===n.cmp(a.nh)&&c.n.sub(n).toArrayLike(r,"be",32).copy(i,32),i},t.signatureExport=function(e){var t=e.slice(0,32),n=e.slice(32,64);if(new o(t).cmp(c.n)>=0||new o(n).cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:n}},t.signatureImport=function(e){var t=new o(e.r);t.cmp(c.n)>=0&&(t=new o(0));var n=new o(e.s);return n.cmp(c.n)>=0&&(n=new o(0)),r.concat([t.toArrayLike(r,"be",32),n.toArrayLike(r,"be",32)])},t.sign=function(e,t,n,i){if("function"===typeof n){var s=n;n=function(n){var a=s(e,t,null,i,n);if(!r.isBuffer(a)||32!==a.length)throw new Error(u.ECDSA_SIGN_FAIL);return new o(a)}}var f=new o(t);if(f.cmp(c.n)>=0||f.isZero())throw new Error(u.ECDSA_SIGN_FAIL);var d=a.sign(e,t,{canonical:!0,k:n,pers:i});return{signature:r.concat([d.r.toArrayLike(r,"be",32),d.s.toArrayLike(r,"be",32)]),recovery:d.recoveryParam}},t.verify=function(e,t,n){var r={r:t.slice(0,32),s:t.slice(32,64)},i=new o(r.r),s=new o(r.s);if(i.cmp(c.n)>=0||s.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);if(1===s.cmp(a.nh)||i.isZero()||s.isZero())return!1;var d=f(n);if(null===d)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);return a.verify(e,r,{x:d.pub.x,y:d.pub.y})},t.recover=function(e,t,n,i){var s={r:t.slice(0,32),s:t.slice(32,64)},f=new o(s.r),d=new o(s.s);if(f.cmp(c.n)>=0||d.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);try{if(f.isZero()||d.isZero())throw new Error;var l=a.recoverPubKey(e,s,n);return r.from(l.encode(!0,i))}catch(p){throw new Error(u.ECDSA_RECOVER_FAIL)}},t.ecdh=function(e,n){var r=t.ecdhUnsafe(e,n,!0);return i("sha256").update(r).digest()},t.ecdhUnsafe=function(e,t,n){var i=f(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);var s=new o(t);if(s.cmp(c.n)>=0||s.isZero())throw new Error(u.ECDH_FAIL);return r.from(i.pub.mul(s).encode(!0,n))}},4013:function(e,t,n){"use strict";for(var r="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},o=0;o<r.length;o++){var s=r.charAt(o);if(void 0!==i[s])throw new TypeError(s+" is ambiguous");i[s]=o}function u(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function a(e){for(var t=1,n=0;n<e.length;++n){var r=e.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+e+")";t=u(t)^r>>5}for(t=u(t),n=0;n<e.length;++n){var i=e.charCodeAt(n);t=u(t)^31&i}return t}function c(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var n=e.toLowerCase(),r=e.toUpperCase();if(e!==n&&e!==r)return"Mixed-case string "+e;var o=(e=n).lastIndexOf("1");if(-1===o)return"No separator character for "+e;if(0===o)return"Missing prefix for "+e;var s=e.slice(0,o),c=e.slice(o+1);if(c.length<6)return"Data too short";var f=a(s);if("string"===typeof f)return f;for(var d=[],l=0;l<c.length;++l){var p=c.charAt(l),h=i[p];if(void 0===h)return"Unknown character "+p;f=u(f)^h,l+6>=c.length||d.push(h)}return 1!==f?"Invalid checksum for "+e:{prefix:s,words:d}}function f(e,t,n,r){for(var i=0,o=0,s=(1<<n)-1,u=[],a=0;a<e.length;++a)for(i=i<<t|e[a],o+=t;o>=n;)o-=n,u.push(i>>o&s);if(r)o>0&&u.push(i<<n-o&s);else{if(o>=t)return"Excess padding";if(i<<n-o&s)return"Non-zero padding"}return u}e.exports={decodeUnsafe:function(){var e=c.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=c.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,t,n){if(n=n||90,e.length+7+t.length>n)throw new TypeError("Exceeds length limit");var i=a(e=e.toLowerCase());if("string"===typeof i)throw new Error(i);for(var o=e+"1",s=0;s<t.length;++s){var c=t[s];if(c>>5!==0)throw new Error("Non 5-bit word");i=u(i)^c,o+=r.charAt(c)}for(s=0;s<6;++s)i=u(i);for(i^=1,s=0;s<6;++s){o+=r.charAt(i>>5*(5-s)&31)}return o},toWordsUnsafe:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},4014:function(e,t,n){"use strict";(function(t){e.exports=function(e,n){if(!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(e===n)return!0;if("function"===typeof e.equals)return e.equals(n);if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}}).call(this,n(27).Buffer)},4050:function(e,t,n){(function(t){const r=n(1081),i=n(4013),o=n(4014),s=n(764),u=n(3994),a=n(2719),c="p2wpkh",f="p2sh(p2wpkh)";function d(e){return s("sha256").update(e).digest()}function l(e){return s("ripemd160").update(d(e)).digest()}function p(e,n,r,i){return void 0!==i?(n+=8,i===c&&(n+=4)):r&&(n+=4),t.concat([t.alloc(1,n+27),e])}function h(e,n){n=n||"\x18Bitcoin Signed Message:\n",t.isBuffer(n)||(n=t.from(n,"utf8")),t.isBuffer(e)||(e=t.from(e,"utf8"));const r=a.encodingLength(e.length),i=t.allocUnsafe(n.length+r+e.length);return n.copy(i,0),a.encode(e.length,i,n.length),e.copy(i,n.length+r),function(e){return d(d(e))}(i)}function y(e,t){"object"===typeof e&&void 0===t&&(t=e,e=void 0);let{segwitType:n,extraEntropy:r}=t||{};if(n&&("string"===typeof n||n instanceof String)&&(n=n.toLowerCase()),n&&n!==f&&n!==c)throw new Error('Unrecognized segwitType: use "'+f+'" or "'+c+'"');return{messagePrefixArg:e,segwitType:n,extraEntropy:r}}function v(e){return e&&"function"===typeof e.sign}function g(e){return l(t.concat([t.from("0014","hex"),e]))}function E(e){const n=i.decode(e),r=i.fromWords(n.words.slice(1));return t.from(r)}e.exports={magicHash:h,sign:function(e,t,n,r,i){const{messagePrefixArg:o,segwitType:s,extraEntropy:a}=y(r,i),c=h(e,o),f=v(t)?t.sign(c,a):u.sign(c,t,{data:a});return p(f.signature,f.recovery,n,s)},signAsync:function(e,t,n,r,i){let o,s,a;return Promise.resolve().then(()=>{({messagePrefixArg:o,segwitType:s,extraEntropy:a}=y(r,i));const n=h(e,o);return v(t)?t.sign(n,a):u.sign(n,t,{data:a})}).then(e=>p(e.signature,e.recovery,n,s))},verify:function(e,n,i,s,a){t.isBuffer(i)||(i=t.from(i,"base64"));const d=function(e){if(65!==e.length)throw new Error("Invalid signature length");const t=e.readUInt8(0)-27;if(t>15||t<0)throw new Error("Invalid signature parameter");return{compressed:!!(12&t),segwitType:8&t?4&t?c:f:null,recovery:3&t,signature:e.slice(1)}}(i);if(a&&!d.compressed)throw new Error("checkSegwitAlways can only be used with a compressed pubkey signature flagbyte");const p=h(e,s),y=l(u.recover(p,d.signature,d.recovery,d.compressed));let v,I;if(d.segwitType)d.segwitType===f?(v=g(y),I=r.decode(n).slice(1)):(v=y,I=E(n));else if(a)try{return I=E(n),o(y,I)}catch(m){const e=g(y);return I=r.decode(n).slice(1),o(y,I)||o(e,I)}else v=y,I=r.decode(n).slice(1);return o(v,I)}}}).call(this,n(27).Buffer)},4136:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"Provider",(function(){return O}));var r=n(13),i=n.n(r),o=n(4),s=n.n(o),u=n(2),a=n.n(u),c=n(3),f=n.n(c),d=n(6),l=n.n(d),p=n(21),h=n.n(p),y=n(308),v=n(968),g=n(4050),E=n.n(g),I=n(1081),m=n.n(I),A=n(627),w=n(540),_=n(682),b=n(975),T=n(4213),P=n(4214);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=function(e,t){if(!e)throw t||"Invalid statement",t instanceof Error?t:new Error(t)},S=function(e,t){return L("undefined"!==typeof e,t||"Expect defined but actually undefined"),e},D=function(e,t,n){return Object(A.verify)("secp256k1",e,t,n)},O=function(){function t(e){this.chainInfo=e}var n=t.prototype;return n.decodeAddress=function(e){return e},n.encodeAddress=function(e){return e},n.xpubToAddresses=function(e,t,n){var r=m.a.decode(e),i=parseInt(r.slice(0,4).toString("hex"),16),o=null!=n?n:this.versionBytesToEncodings.public[i][0],s={},u={chainCode:r.slice(13,45),key:r.slice(45,78)},a=new Map;for(var c of t){var f=u,d="",l=c.split("/");for(var p of l)if(d+=""===d?p:"/"+p,a.has(d))f=a.get(d);else{var h=p.endsWith("'")?parseInt(p.slice(0,-1))+2**31:parseInt(p);f=Object(A.CKDPub)("secp256k1",f,h),a.set(d,f)}var y=this.pubkeyToPayment(f.key,o).address;"string"===typeof y&&y.length>0&&(y=this.encodeAddress(y),s[c]=y)}return s},n.pubkeyToPayment=function(e,t){Object(_.initBitcoinEcc)();var n={pubkey:e,network:this.network};switch(t){case w.AddressEncodings.P2PKH:n=v.payments.p2pkh(n);break;case w.AddressEncodings.P2WPKH:n=v.payments.p2wpkh(n);break;case w.AddressEncodings.P2SH_P2WPKH:n=v.payments.p2sh({redeem:v.payments.p2wpkh(n),network:this.network});break;case w.AddressEncodings.P2TR:n=v.payments.p2tr({internalPubkey:e.slice(1,33),network:this.network});break;default:throw new Error("Invalid encoding: "+t)}return n},n.parseAddressEncodings=function(e){var t=this;return Promise.all(e.map((function(e){return t.verifyAddress(e)}))).then((function(e){return e.filter((function(e){return e.isValid})).map((function(e){return e.encoding}))}))},n.getAccount=function(e,t){var n=this.getEncodingXpub({params:e,addressEncoding:t}),r={};switch(e.type){case"simple":r={details:"basic"};break;case"details":r={details:"tokenBalances",tokens:"derived"};break;case"history":r={details:"txs",pageSize:50,to:e.to};break;case"usedAddress":r={details:"tokenBalances",tokens:"used"};break;case"accountInfo":r={details:e.details,from:e.from,to:e.to,pageSize:e.pageSize};break;default:throw new Error("type not support: "+e.type)}return this.blockbook.then((function(e){return e.getAccount(n,r)}))},n.getAccountWithAddress=function(e){var t={};switch(e.type){case"simple":t={details:"basic"}}return this.blockbook.then((function(n){return n.getAccountWithAddress(e.address,t)}))},n.getEncodingXpub=function(e){var t=e.params,n=e.addressEncoding,r=e.safeGet;if(!t.xpub){if(r)return"";throw new Error("getEncodingXpub ERROR: xpub is required")}var i=n;if(Object(_.isTaprootXpubSegwit)(t.xpub)||Object(_.isWatchAccountTaprootSegwit)(t.xpub))i=w.AddressEncodings.P2TR;else{var o=m.a.decode(t.xpub);L(this.isValidXpub(o));var s=parseInt(o.slice(0,4).toString("hex"),16);i=null!=n?n:this.versionBytesToEncodings.public[s][0]}L("undefined"!==typeof i);var u=t.xpub;switch(i){case w.AddressEncodings.P2PKH:u="pkh("+t.xpub+")";break;case w.AddressEncodings.P2SH_P2WPKH:u="sh(wpkh("+t.xpub+"))";break;case w.AddressEncodings.P2WPKH:u="wpkh("+t.xpub+")";break;case w.AddressEncodings.P2TR:u=t.xpub}return u},n.getHistory=function(e,t,n,r,i){var o=this.getEncodingXpub({params:e,safeGet:!0});return this.blockbook.then((function(e){return e.getHistory(t,n,o,r,i)}))},n.isValidXpub=function(e){return this.isValidExtendedKey(e,"pub")},n.isValidXprv=function(e){return this.isValidExtendedKey(e,"prv")},n.isValidExtendedKey=function(e,t){var n="string"===typeof e?m.a.decode(e):e;if(78!==n.length)return!1;var r=parseInt(n.slice(0,4).toString("hex"),16);return"pub"===t?"undefined"!==typeof this.versionBytesToEncodings.public[r]:"undefined"!==typeof this.versionBytesToEncodings.private[r]},n.verifyAddress=function(e){var t,n=this.decodeAddress(e);try{var r=v.address.fromBase58Check(n);r.version===this.network.pubKeyHash&&20===r.hash.length?t=w.AddressEncodings.P2PKH:r.version===this.network.scriptHash&&20===r.hash.length&&(t=w.AddressEncodings.P2SH_P2WPKH)}catch(o){try{var i=v.address.fromBech32(n);0===i.version&&i.prefix===this.network.bech32&&20===i.data.length?t=w.AddressEncodings.P2WPKH:0===i.version&&i.prefix===this.network.bech32&&32===i.data.length?t=w.AddressEncodings.P2WSH:1===i.version&&i.prefix===this.network.bech32&&32===i.data.length&&(t=w.AddressEncodings.P2TR)}catch(s){}}return t?{displayAddress:n,normalizedAddress:n,encoding:t,isValid:!0}:{isValid:!1}},n.buildUnsignedTx=function(e){var t=e.encodedTx,n=e.inputs,r=e.outputs,i=e.feeLimit,o=e.feePricePerUnit,s=(null!=t?t:{}).inputsForCoinSelect,u=null==s?void 0:s.filter((function(e){return n.some((function(t){var n;return(null==(n=t.utxo)?void 0:n.txid)===e.txId&&t.utxo.vout===e.vout}))}));if(Number(null==u?void 0:u.length)>0&&r.length>0){var a,c=Object(P.estimateTxSize)(null!=u?u:[],null!=(a=r.map((function(e){return{address:e.address,value:parseInt(e.value.toFixed())}})))?a:[]);i=i&&i.gte(c)?i:new h.a(c)}return i=i||new h.a(P.PLACEHOLDER_VSIZE),Promise.resolve(x(x({},e),{},{feeLimit:i,feePricePerUnit:o}))},n.getBalances=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var n=e.address;return t.getBalance(n)})))}))},n.getBalancesByAddress=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var n=e.address;return t.getBalanceWithAddress(n)})))}))},n.getUTXOs=function(){var e=a()((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.blockbook.then((function(n){return n.getUTXOs(e,t)}))}));return function(t){return e.apply(this,arguments)}}(),n.getPsbt=function(){return new v.Psbt({network:this.network})},n.getBitcoinSigner=function(){var e=a()((function*(e,t){return{publicKey:yield e.getPubkey(!0),sign:function(){var t=a()((function*(t){var n=yield e.sign(t);return s()(n,1)[0]}));return function(e){return t.apply(this,arguments)}}()}}));return function(t,n){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=a()((function*(e,t){for(var n=yield this.packTransaction(e,t),r=0;r<e.inputs.length;++r){var i=t[e.inputs[r].address],o=n.data.inputs[0],s=yield this.getBitcoinSigner(i,o);yield n.signInputAsync(r,s)}n.validateSignaturesOfAllInputs(D),n.finalizeAllInputs();var u=n.extractTransaction();return{txid:u.getId(),rawTx:u.toHex()}}));return function(t,n){return e.apply(this,arguments)}}(),n.packTransaction=function(){var t=a()((function*(t,n){for(var r=t.inputs,i=t.outputs,o=t.payload.opReturn,u=yield this.collectInfoForSoftwareSign(t),a=s()(u,2),c=a[0],f=a[1],d=this.getPsbt(),l=0;l<r.length;++l){var p=r[l],h=p.utxo;L(h);var y=c[l],g={};switch(y){case w.AddressEncodings.P2PKH:g.nonWitnessUtxo=e.from(f[h.txid],"hex");break;case w.AddressEncodings.P2WPKH:g.witnessUtxo={script:S(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),y)).output,value:h.value.integerValue().toNumber()};break;case w.AddressEncodings.P2SH_P2WPKH:var E,I=S(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),y));g.witnessUtxo={script:I.output,value:h.value.integerValue().toNumber()},g.redeemScript=null==(E=I.redeem)?void 0:E.output;break;case w.AddressEncodings.P2TR:var m=S(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),y));g.witnessUtxo={script:m.output,value:h.value.integerValue().toNumber()},g.tapInternalKey=m.internalPubkey}d.addInput(x({hash:h.txid,index:h.vout},g))}if(i.forEach((function(e){d.addOutput({address:e.address,value:e.value.integerValue().toNumber()})})),"string"===typeof o){var A=v.payments.embed({data:[Object(P.loadOPReturn)(o)]});d.addOutput({script:S(A.output),value:0})}return d}));return function(e,n){return t.apply(this,arguments)}}(),n.collectInfoForSoftwareSign=function(){var e=a()((function*(e){var t=e.inputs,n=yield this.parseAddressEncodings(t.map((function(e){return e.address})));L(n.length===t.length,"Found invalid address from inputs");var r=Array.from(new Set(n.map((function(e,n){if(e===w.AddressEncodings.P2PKH)return S(t[n].utxo).txid})).filter((function(e){return!!e}))));return[n,yield this.collectTxs(r)]}));return function(t){return e.apply(this,arguments)}}(),n.collectTxs=function(){var e=a()((function*(e){for(var t=yield this.blockbook,n={},r=function*(){var r=e.slice(i,i+o),s=yield Promise.all(r.map((function(e){return t.getRawTransaction(e)})));r.forEach((function(e,t){return n[e]=s[t]}))},i=0,o=5;i<e.length;i+=o)yield*r();return n}));return function(t){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(e){return this.blockbook.then((function(t){return t.broadcastTransaction(e)}))},n.getTransactionStatuses=function(e){return this.blockbook.then((function(t){return t.getTransactionStatuses(e)}))},n.signMessage=function(e,t,n,r){Object(_.initBitcoinEcc)();var i=Object(A.mnemonicFromEntropy)(t,e),o=Object(y.mnemonicToSeedSync)(i),s=Object(_.getBitcoinBip32)().fromSeed(o).derivePath(n),u=Object(_.getBitcoinECPair)().fromWIF(s.toWIF());return E.a.sign(r,u.privateKey,u.compressed,{segwitType:"p2wpkh"})},l()(t,[{key:"network",get:function(){return Object(T.getNetwork)(this.chainInfo.code)}},{key:"blockbook",get:function(){return Object(b.getBlockBook)(this.chainInfo)}},{key:"versionBytesToEncodings",get:function(){if("undefined"===typeof this._versionBytesToEncodings){var e,t,n=this.network,r={public:(e={},e[n.bip32.public]=[w.AddressEncodings.P2PKH],e),private:(t={},t[n.bip32.private]=[w.AddressEncodings.P2PKH],t)};Object.entries(n.segwitVersionBytes||{}).forEach((function(e){var t=s()(e,2),n=t[0],o=t[1],u=o.public,a=o.private;r.public[u]=[].concat(i()(r.public[u]||[]),[n]),r.private[a]=[].concat(i()(r.private[a]||[]),[n])})),this._versionBytesToEncodings=r}return this._versionBytesToEncodings}}]),t}()}.call(this,n(27).Buffer)},4213:function(e,t,n){"use strict";n.r(t),n.d(t,"isNetworkType",(function(){return I})),n.d(t,"getNetwork",(function(){return g}));var r,i,o,s,u=n(3),a=n.n(u),c=n(968),f=n(1366),d=n.n(f),l=n(540);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128,forkId:0},v={btc:h(h({},c.networks.bitcoin),{},{segwitVersionBytes:(r={},r[l.AddressEncodings.P2SH_P2WPKH]={public:77429938,private:77428856},r[l.AddressEncodings.P2WPKH]={public:78792518,private:78791436},r[l.AddressEncodings.P2TR]={public:76067358,private:76066276},r)}),tbtc:h(h({},c.networks.testnet),{},{segwitVersionBytes:(i={},i[l.AddressEncodings.P2SH_P2WPKH]={public:71979618,private:71978536},i[l.AddressEncodings.P2WPKH]={public:73342198,private:73341116},i[l.AddressEncodings.P2TR]={public:70617039,private:70615956},i)}),rbtc:h(h({},c.networks.regtest),{},{segwitVersionBytes:(o={},o[l.AddressEncodings.P2SH_P2WPKH]={public:71979618,private:71978536},o[l.AddressEncodings.P2WPKH]={public:73342198,private:73341116},o)}),ltc:{messagePrefix:"\x19Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:27108450,private:27106558},segwitVersionBytes:(s={},s[l.AddressEncodings.P2SH_P2WPKH]={public:28471030,private:28469138},s[l.AddressEncodings.P2WPKH]={public:78792518,private:78791436},s),pubKeyHash:48,scriptHash:50,wif:176},bch:y,doge:{messagePrefix:"\x19Dogecoin Signed Message:\n",bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158},btg:{messagePrefix:"\x1dBitcoin Gold Signed Message:\n",bech32:"btg",bip32:{public:76067358,private:76066276},pubKeyHash:38,scriptHash:23,wif:128},dgb:{messagePrefix:"\x19DigiByte Signed Message:\n",bech32:"dgb",bip32:{public:76067358,private:76066276},pubKeyHash:30,scriptHash:63,wif:176},nmc:{messagePrefix:"\x19Namecoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:52,scriptHash:5,wif:128},vtc:{messagePrefix:"\x19Vertcoin Signed Message:\n",bech32:"vtc",bip32:{public:76067358,private:76066276},pubKeyHash:71,scriptHash:5,wif:128},dash:{messagePrefix:"\x19DarkCoin Signed Message:\n",bech32:"",bip32:{public:50221772,private:50221816},pubKeyHash:76,scriptHash:16,wif:204}},g=function(e){var t=v[e];if("undefined"===typeof t)throw new Error("Network not found. chainCode: "+e);return t},E={bitcoinCash:[y]};function I(e,t){if("string"!==typeof e||!t||!E[e])return!1;try{d()({bip32:{public:d.a.UInt32,private:d.a.UInt32},pubKeyHash:d.a.anyOf(d.a.UInt8,d.a.UInt16),scriptHash:d.a.anyOf(d.a.UInt8,d.a.UInt16)},t)}catch(n){return!1}return!!E[e].find((function(e){return e.bip32.public===t.bip32.public&&e.bip32.private===t.bip32.private&&(!e.bech32&&!t.bech32||e.bech32===t.bech32)&&(!e.forkId&&!t.forkId||e.forkId===t.forkId)&&e.pubKeyHash===t.pubKeyHash&&e.scriptHash===t.scriptHash}))}},4214:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"estimateVsize",(function(){return c})),n.d(t,"estimateTxSize",(function(){return f})),n.d(t,"loadOPReturn",(function(){return a})),n.d(t,"PLACEHOLDER_VSIZE",(function(){return u}));var r=n(314),i=n.n(r),o={P2PKH:148,P2WPKH:68,P2SH_P2WPKH:91},s={P2PKH:34,P2WPKH:31,P2SH_P2WPKH:32},u=79,a=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=e.from(t);return r.slice(0,n)},c=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,i=10,u=e.filter((function(e){return e.includes("P2WPKH")})).length>=1;if(u&&(i+=.5),i+=e.map((function(e){return o[e]||0})).reduce((function(e,t){return e+t}),0),u&&(i+=.25),i+=t.map((function(e){return s[e]||0})).reduce((function(e,t){return e+t}),0),"string"===typeof n){var c=a(n,r).length;i+=12*Math.ceil(c/r),i+=c}return Math.ceil(i)},f=function(e,t){return i.a.transactionBytes(e,t)}}.call(this,n(27).Buffer)},4532:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"getBtcProvider",(function(){return h})),n.d(t,"generateNativeSegwitAccounts",(function(){return y}));var r=n(13),i=n.n(r),o=n(2),s=n.n(o),u=n(1081),a=n.n(u),c=n(4136),f=n(12),d=n(22),l=n(627),p=n(682),h=function(){var e=s()((function*(e,t){var n=yield e.providerManager.getChainInfoByNetworkId(t?"tbtc--0":"btc--0");return new c.Provider(n)}));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var t=s()((function*(t){var n=t.engine,r=t.seed,o=t.password,s=t.indexes,u=t.names,c=t.isTestnet,y=yield h(n,c),v=y.network,g=c?f.IMPL_TBTC:f.IMPL_BTC,E=c?f.COINTYPE_TBTC:f.COINTYPE_BTC,I=Object(p.getAccountDefaultByPurpose)(84,g).addressEncoding,m=0!==s[0],A=[].concat(i()(m?[s[0]-1]:[]),i()(s)),w=Object(l.batchGetPublicKeys)("secp256k1",r,o,"m/84'/"+E+"'",A.map((function(e){return e.toString()+"'"})));if(w.length!==A.length)throw new d.OneKeyInternalError("Unable to get publick key.");var _=((v.segwitVersionBytes||{})[I]||v.bip32).public,b=[],T=0;for(var P of w){var N=P.path,x=P.parentFingerPrint,L=P.extendedKey,S=a.a.encode(e.concat([e.from(_.toString(16).padStart(8,"0"),"hex"),e.from([3]),x,e.from((A[T]+2**31).toString(16).padStart(8,"0"),"hex"),L.chainCode,L.key])),D=y.xpubToAddresses(S,["0/0"],I)["0/0"],O=c?"TLightning":"Lightning",C=(u||[])[T]||O+" #"+(A[T]+1);(!m||T>0)&&b.push({index:A[T],name:C,path:N,xpub:S,address:D}),T+=1}return b}));return function(e){return t.apply(this,arguments)}}()}.call(this,n(27).Buffer)},6127:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ue}));var r=n(4),i=n.n(r),o=n(3),s=n.n(o),u=n(207),a=n.n(u),c=n(2),f=n.n(c),d=n(6),l=n.n(d),p=n(9),h=n.n(p),y=n(14),v=n.n(y),g=n(7),E=n.n(g),I=n(265),m=n(71),A=n(21),w=n.n(A),_=n(47),b=n(18),T=n(139),P=n(22),N=n(375),x=n(52),L=n(3972),S=n(88),D=n.n(S),O=n(66),C=n(102);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R,K=function(){function e(e){var t=this;this.checkAuth=Object(T.memoizee)(function(){var e=f()((function*(e){var n=yield t.getAuthorization(e);if(!n)throw new Error("Bad Auth");return t.request.get("/account/auth/check",{params:{testnet:t.testnet},headers:{Authorization:n}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),{promise:!0,maxAge:Object(_.getTimeDurationMs)({seconds:30})}),this.specialInvoice=Object(T.memoizee)(function(){var e=f()((function*(e,n){return t.request.get("/invoices/invoice",{params:{paymentHash:n,testnet:t.testnet},headers:{Authorization:yield t.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t,n){return e.apply(this,arguments)}}(),{promise:!0,maxAge:Object(_.getTimeDurationMs)({seconds:1})}),this.getConfig=Object(T.memoizee)(function(){var e=f()((function*(e){return t.request.get("/invoices/config",{params:{testnet:t.testnet},headers:{Authorization:yield t.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),{promise:!0,maxAge:Object(_.getTimeDurationMs)({seconds:60})}),this.testnet=e,this.request=D.a.create({baseURL:Object(C.getFiatEndpoint)()+"/lightning",timeout:2e4}),this.request.interceptors.response.use((function(e){return e}),(function(e){return 401===(e.response?e.response.status:null)?Promise.reject(new P.BadAuthError):Promise.reject(e)}))}var t=e.prototype;return t.getAuthorization=function(){var e=f()((function*(e){var t=yield O.default.utxoAccounts.getLndAccessToken(e);return t&&t.length?"Bearer "+t:""}));return function(t){return e.apply(this,arguments)}}(),t.refreshAccessToken=function(){var e=f()((function*(e){var t=e.hashPubKey,n=e.address,r=e.signature,i=e.timestamp,o=e.randomSeed;try{if(!t||!n||!r)throw new Error("Invalid exchange token params");return yield this.request.post("/account/auth",{hashPubKey:t,address:n,signature:r,timestamp:i,randomSeed:o,testnet:this.testnet}).then((function(e){return e.data}))}catch(s){throw s}}));return function(t){return e.apply(this,arguments)}}(),t.checkAccountExist=function(){var e=f()((function*(e){return this.request.get("/account/check",{params:{address:e,testnet:this.testnet}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.createUser=function(){var e=f()((function*(e){var t=e.hashPubKey,n=e.address,r=e.signature,i=e.randomSeed;return this.request.post("/account/users",{hashPubKey:t,address:n,signature:r,randomSeed:i,testnet:this.testnet}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.batchGetBalance=function(){var e=f()((function*(e){try{return yield this.request.post("/account/balance",{addresses:e,testnet:this.testnet}).then((function(e){return e.data}))}catch(t){return[]}}));return function(t){return e.apply(this,arguments)}}(),t.createInvoice=function(){var e=f()((function*(e,t,n){return this.request.post("/invoices/create",{amount:t,description:n||"OneKey Invoice",testnet:this.testnet},{headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t,n,r){return e.apply(this,arguments)}}(),t.decodedInvoice=function(){var e=f()((function*(e){return this.request.get("/invoices/decoded",{params:{invoice:e,testnet:this.testnet}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.getNextNonce=function(){var e=f()((function*(e){return this.request.get("/payments/getNonce",{params:{testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data+1}))}));return function(t){return e.apply(this,arguments)}}(),t.paymentBolt11=function(){var e=f()((function*(e,t){return this.request.post("/payments/bolt11",k(k({},e),{},{testnet:this.testnet}),{headers:{Authorization:yield this.getAuthorization(t)}}).then((function(e){return e.data}))}));return function(t,n){return e.apply(this,arguments)}}(),t.checkBolt11=function(){var e=f()((function*(e){var t=e.address,n=e.nonce;return this.request.get("/payments/checkBolt11",{params:{nonce:n,testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(t)}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.fetchHistory=function(){var e=f()((function*(e){return this.request.get("/invoices/history",{params:{testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.fetchSignTemplate=function(){var e=f()((function*(e,t){return this.request.get("/account/getSignTemplate",{params:{address:e,signType:t,testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t,n){return e.apply(this,arguments)}}(),t.estimateFee=function(){var e=f()((function*(e){var t=e.address,n=e.dest,r=e.amt;return this.request.get("/payments/estimatefee",{params:{dest:n,amt:r,testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(t)}}).then((function(e){return e.data.result}))}));return function(t){return e.apply(this,arguments)}}(),l()(e)}();!function(e){e.StateSettled="settled",e.StateInitialized="initialized",e.StateOpen="open",e.StateError="error"}(R||(R={}));var V=n(808),H=n(1016),j=n.n(H),Y=n(4532),U=function(){var e=f()((function*(e){var t=e.msgPayload,n=e.engine,r=e.path,i=e.password,o=e.entropy,s=e.isTestnet,u=(yield Object(Y.getBtcProvider)(n,s)).signMessage(i,o,r+"/0/0",j()(t));return b.default.common.debug("Lightning Signature, msgPayload: "+j()(t)+", path: "+r+", result: "+u.toString("hex")),u.toString("hex")}));return function(t){return e.apply(this,arguments)}}();function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var G=function(e){h()(n,e);var t=F(n);function n(){return t.apply(this,arguments)}return l()(n)}(n(3975).KeyringHardwareBase),M=n(1392),W=n(12),z=n(115);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var J=function(e){h()(n,e);var t=X(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){return Promise.resolve({})},r.prepareAccounts=function(){var e=f()((function*(e){var t=e.password,n=e.indexes,r=e.names,i=yield this.engine.dbApi.getCredential(this.walletId,t),o=i.seed,s=i.entropy,u=yield this.vault.getNetwork(),a=yield Object(Y.generateNativeSegwitAccounts)({engine:this.engine,seed:o,password:t,indexes:n,names:r,isTestnet:u.isTestnet}),c=yield this.vault.getClient(),f=[];for(var d of a){if(!(yield c.checkAccountExist(d.address))){var l=Object(m.bytesToHex)(Object(I.sha256)(d.xpub)),p=yield c.fetchSignTemplate(d.address,"register");if("register"!==p.type)throw new Error("Wrong signature type");var h=yield U({msgPayload:Z(Z({},p),{},{pubkey:l,address:d.address}),engine:this.engine,path:d.path,password:t,entropy:s,isTestnet:u.isTestnet});yield c.createUser({hashPubKey:l,address:d.address,signature:h,randomSeed:p.randomSeed})}var y=u.isTestnet?W.COINTYPE_LIGHTNING_TESTNET:W.COINTYPE_LIGHTNING,v="m/44'/"+y+"'/"+d.index;f.push({id:this.walletId+"--"+v,name:d.name,type:z.AccountType.VARIANT,path:v,coinType:y,pub:d.xpub,address:"",addresses:{normalizedAddress:d.address,realPath:d.path,hashAddress:Object(m.bytesToHex)(Object(M.ripemd160)(d.address))}})}return f}));return function(t){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=f()((function*(e,t){b.default.sendTx.info("signTransaction result",e);var n=t.password,r=yield this.getDbAccount(),i=(yield this.engine.dbApi.getCredential(this.walletId,null!=n?n:"")).entropy,o=e.encodedTx,s=o.invoice,u=o.expired,a=o.created,c=o.paymentHash,f=yield this.vault.getClient(),d=yield f.fetchSignTemplate(r.addresses.normalizedAddress,"transfer");if("transfer"!==d.type)throw new Error("Wrong transfer signature type");var l=yield this.vault.getNetwork();return{txid:c,rawTx:yield U({msgPayload:Z(Z({},d),{},{paymentHash:c,invoice:s,expired:u,created:Number(a),nonce:d.nonce,randomSeed:d.randomSeed}),engine:this.engine,path:r.addresses.realPath,password:null!=n?n:"",entropy:i,isTestnet:l.isTestnet}),nonce:d.nonce,randomSeed:d.randomSeed}}));return function(t,n){return e.apply(this,arguments)}}(),l()(n)}(n(3976).KeyringHdBase);function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var $=function(e){h()(n,e);var t=Q(n);function n(){return t.apply(this,arguments)}return l()(n)}(n(3977).KeyringImportedBase);function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var te,ne=function(e){h()(n,e);var t=ee(n);function n(){return t.apply(this,arguments)}return l()(n)}(n(3978).KeyringWatchingBase),re=n(1461);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=E()(e);if(t){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}!function(e){e.NOT_FOUND_ORDER="NOT_FOUND_ORDER",e.SUCCESS="SUCCESS",e.FAILED="FAILED",e.PENDING="PENDING"}(te||(te={}));var ue=function(e){h()(n,e);var t=se(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).keyringMap={hd:J,hw:G,imported:$,watching:ne,external:ne},e.settings=re.default,e.getClientCache=Object(T.memoizee)((function(e){return new K(e)}),{maxAge:Object(_.getTimeDurationMs)({minute:3})}),e._decodedInvoceCache=Object(T.memoizee)(function(){var t=f()((function*(t){return(yield e.getClient()).decodedInvoice(t)}));return function(e){return t.apply(this,arguments)}}(),{maxAge:Object(_.getTimeDurationMs)({seconds:30})}),e}var r=n.prototype;return r.getOutputAccount=function(){var e=f()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:a()(e,"pub",""),addresses:JSON.stringify(a()(e,"addresses",{}))}}));return function(){return e.apply(this,arguments)}}(),r.getClient=function(){var e=f()((function*(){var e=yield this.getNetwork();return this.getClientCache(e.isTestnet)}));return function(){return e.apply(this,arguments)}}(),r.exchangeToken=function(){var e=f()((function*(e){try{if(!e)throw new Error("No Password");var t=yield this.getDbAccount(),n=t.addresses.normalizedAddress,r=Object(m.bytesToHex)(Object(I.sha256)(t.pub)),i=yield this.getNetwork(),o=(yield this.engine.dbApi.getCredential(this.walletId,null!=e?e:"")).entropy,s=yield this.getClient(),u=yield s.fetchSignTemplate(n,"auth");if("auth"!==u.type)throw new Error("Invalid auth sign template");var a=Date.now(),c=yield U({msgPayload:oe(oe({},u),{},{pubkey:r,address:n,timestamp:a}),engine:this.engine,path:t.addresses.realPath,password:null!=e?e:"",entropy:o,isTestnet:i.isTestnet});return yield s.refreshAccessToken({hashPubKey:r,address:n,signature:c,timestamp:a,randomSeed:u.randomSeed})}catch(f){throw b.default.common.info("exchangeToken error",f),f}}));return function(t){return e.apply(this,arguments)}}(),r.addressFromBase=function(e){return Promise.resolve("")},r.getFetchBalanceAddress=function(e){return Promise.resolve(e.addresses.normalizedAddress)},r.getCurrentBalanceAddress=function(){var e=f()((function*(){return(yield this.getDbAccount()).addresses.normalizedAddress}));return function(){return e.apply(this,arguments)}}(),r.getHashAddress=function(){var e=f()((function*(){return(yield this.getDbAccount()).addresses.hashAddress}));return function(){return e.apply(this,arguments)}}(),r.validateSendAmount=function(){var e=f()((function*(e){if(new w.a(e).isGreaterThan(1e6))throw new P.MaxSendAmountError("msg__the_sending_amount_cannot_exceed_int_sats",{0:1e6});return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=f()((function*(e){try{var t=Object(V.findLnurl)(e);if(!t)throw new Error("not a lnurl");return t}catch(n){}try{return yield this._decodedInvoceCache(e),e}catch(n){throw new P.InvalidLightningPaymentRequest}}));return function(t){return e.apply(this,arguments)}}(),r.fetchFeeInfo=function(){var e=f()((function*(e){var t,n=yield this.engine.getNetwork(this.networkId);return{customDisabled:!0,limit:new w.a(null!=(t=e.fee)?t:"0").toFixed(),prices:["1"],defaultPresetIndex:"0",feeSymbol:n.feeSymbol,feeDecimals:n.feeDecimals,nativeSymbol:n.symbol,nativeDecimals:n.decimals,waitingSeconds:[5],tx:null}}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromTransfer=function(){var e=f()((function*(e){var t,n,r,i=yield this.getClient(),o=yield this.getCurrentBalanceAddress(),s=yield this._decodedInvoceCache(e.to),u=yield i.getConfig(o),a=s.tags.find((function(e){return"payment_hash"===e.tagName})),c=s.millisatoshis?new w.a(s.millisatoshis).dividedBy(1e3):new w.a(null!=(t=s.satoshis)?t:"0");if(this.isZeroAmountInvoice(s)&&e.amount&&(c=new w.a(e.amount)),!s.paymentRequest)throw new P.InvalidLightningPaymentRequest;var f=s.tags.find((function(e){return"description"===e.tagName})),d=0;try{var l;d=yield i.estimateFee({address:o,dest:null!=(l=s.payeeNodeKey)?l:"",amt:c.toFixed()})}catch(p){}return{invoice:s.paymentRequest,paymentHash:null==a?void 0:a.data,amount:c.toFixed(),expired:""+(null!=(n=s.timeExpireDate)?n:""),created:""+Math.floor(Date.now()/1e3),description:null==f?void 0:f.data,fee:d,isExceedTransferLimit:new w.a(c).isGreaterThan(u.maxSendAmount),config:u,successAction:null==(r=e.lnurlPaymentInfo)?void 0:r.successAction}}));return function(t){return e.apply(this,arguments)}}(),r.updateEncodedTx=function(e){return Promise.resolve(e)},r.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},r.buildUnsignedTxFromEncodedTx=function(){var e=f()((function*(e){return Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})}));return function(t){return e.apply(this,arguments)}}(),r.decodeTx=function(){var e=f()((function*(e,t){var n=yield this.getDbAccount(),r=yield this.getHashAddress(),i=yield this.engine.getNativeTokenInfo(this.networkId),o=null;return e.description&&(o={memo:e.description}),{txid:"",owner:n.name,signer:"",nonce:0,actions:[{type:x.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:i,from:r,to:"",amount:new w.a(e.amount).toFixed(),amountValue:e.amount,extraInfo:null},direction:x.IDecodedTxDirection.OUT}],status:x.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:e,payload:t,extraInfo:o}}));return function(t,n){return e.apply(this,arguments)}}(),r.decodedTxToLegacy=function(e){return Promise.resolve({})},r.fetchOnChainHistory=function(){var e=f()((function*(e){var t=this,n=yield this.getDbAccount(),r=n.addresses.normalizedAddress,i=n.addresses.hashAddress,o=yield this.engine.getNetwork(this.networkId),s=o.decimals,u=(o.symbol,yield this.engine.getNativeTokenInfo(this.networkId)),a=yield this.getClient(),c=(yield a.fetchHistory(r)).map((function(r){try{var o,a,c=r.txid,f=(r.owner,r.signer),d=r.nonce,l=r.actions,p=r.fee,h=r.status,y=null==(o=e.localHistory)?void 0:o.find((function(e){return e.decodedTx.txid===c}));if(y&&y.decodedTx.isFinal)return null;var v=new w.a(r.amount).shiftedBy(-s).toFixed(),g=""+r.amount,E=l[0],I=E.direction,m=E.type,A=I===x.IDecodedTxDirection.IN?"":i,_=I===x.IDecodedTxDirection.IN?i:"",b={txid:c,owner:n.name,signer:f,nonce:d,actions:[{type:m,direction:I,nativeTransfer:{tokenInfo:u,from:A,to:_,amount:v,amountValue:g,extraInfo:null}}],status:h,networkId:t.networkId,accountId:t.accountId,extraInfo:{preimage:r.payment_preimage,memo:r.description},totalFeeInNative:new w.a(p).shiftedBy(-s).toFixed()};return b.updatedAt=new Date(r.settled_at).getTime(),b.createdAt=null!=(a=null==y?void 0:y.decodedTx.createdAt)?a:new Date(r.settled_at).getTime(),b.isFinal=b.status===x.IDecodedTxStatus.Confirmed||b.status===x.IDecodedTxStatus.Failed,t.buildHistoryTx({decodedTx:b,historyTxToMerge:y})}catch(T){return Promise.resolve(null)}}));return(yield Promise.all(c)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),r.fixActionDirection=function(){var e=f()((function*(e){var t=e.action;e.accountAddress;return t}));return function(t){return e.apply(this,arguments)}}(),r.getAccountBalance=function(){var e=f()((function*(e,t){var n=e.map((function(e){}));if(!t)return n;var r=yield this.getDbAccount(),o=yield this.getBalances([{address:r.addresses.normalizedAddress}]);return[i()(o,1)[0]].concat(n)}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=f()((function*(e){var t=yield this.getClient(),n=yield t.batchGetBalance(e.map((function(e){return e.address})));return e.map((function(e){var t,r=n.find((function(t){return t.address===e.address}));return new w.a(null!=(t=null==r?void 0:r.balance)?t:0)}))}));return function(t){return e.apply(this,arguments)}}(),r.createInvoice=function(){var e=f()((function*(e,t){var n=yield this.getClient(),r=yield this.getCurrentBalanceAddress();return n.createInvoice(r,e,t)}));return function(t,n){return e.apply(this,arguments)}}(),r.broadcastTransaction=function(){var e=f()((function*(e,t){var n;b.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});try{var r=yield this.getClient(),i=e.encodedTx,o=i.invoice,s=i.amount,u=i.expired,a=i.created,c=i.paymentHash,f=yield this.getCurrentBalanceAddress();if("number"!==typeof e.nonce||"number"!==typeof e.randomSeed)throw new Error("Invalid nonce or randomSeed");n=yield r.paymentBolt11({invoice:o,paymentHash:c,amount:s,expired:u,created:Number(a),signature:e.rawTx,nonce:e.nonce,randomSeed:e.randomSeed},f),yield this.pollBolt11Status(f,e.nonce)}catch(d){throw b.default.sendTx.info("broadcastTransaction ERROR:",d),d}return b.default.engine.info("broadcastTransaction END:",{txid:e.txid,rawTx:e.rawTx,result:n}),oe(oe(oe({},e),n),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.pollBolt11Status=function(){var e=f()((function*(e,t){var n=this;return new Promise(function(){var r=f()((function*(r,i){var o=yield n.getClient(),s=setInterval(f()((function*(){try{var n=yield o.checkBolt11({address:e,nonce:Number(t)});if(n.status===te.NOT_FOUND_ORDER)return;if(n.status===te.SUCCESS&&(clearInterval(s),r(N.TransactionStatus.CONFIRM_AND_SUCCESS)),n.status===te.FAILED){var u;clearInterval(s);var a=null==n||null==(u=n.data)?void 0:u.message;if("invoice is already paid"===(null==a?void 0:a.toLowerCase()))i(new P.InvoiceAlreadPaid);else if("no_route"===a)i(new P.NoRouteFoundError);else if("insufficient_balance"===a)i(new P.ChannelInsufficientLiquidityError);else if("invoice expired"===a)i(new P.InvoiceExpiredError);else{var c;i(new Error(null==(c=n.data)?void 0:c.message))}}}catch(f){clearInterval(s),i(f)}})),1500)}));return function(e,t){return r.apply(this,arguments)}}())}));return function(t,n){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(){var e=f()((function*(e){var t=this,n=yield this.getCurrentBalanceAddress();return Promise.all(e.map(function(){var e=f()((function*(e){var r,i=yield t.getClient();try{var o=yield i.specialInvoice(n,e);return(r=o.status)===R.StateOpen||r===R.StateInitialized?N.TransactionStatus.PENDING:r===R.StateSettled?N.TransactionStatus.CONFIRM_AND_SUCCESS:r===R.StateError?N.TransactionStatus.CONFIRM_BUT_FAILED:void 0}catch(u){var s;return"Bad arguments"===(null==u||null==(s=u.response)?void 0:s.data.message)?N.TransactionStatus.CONFIRM_BUT_FAILED:N.TransactionStatus.PENDING}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromApprove=function(e){throw new Error("Method not implemented.")},r.updateEncodedTxTokenApprove=function(e,t){throw new Error("Method not implemented.")},r.getExportedCredential=function(e,t){throw new Error("Method not implemented.")},r.fetchTokenInfos=function(e){throw new Error("Method not implemented.")},r.specialCheckEncodedTx=function(){var e=f()((function*(e){var t=e.invoice,n=e.amount,r=e.fee,i=yield this._decodedInvoceCache(t),o=n;if(this.isZeroAmountInvoice(i)){if(new w.a(e.amount).isLessThan(1))return Promise.resolve({success:!1,key:"msg__the_invoice_amount_cannot_be_0",params:{0:"stas"}});o=e.amount}var s=yield this.getCurrentBalanceAddress(),u=yield this.getBalances([{address:s}]);if(new w.a(u[0]||"0").isLessThan(new w.a(o).plus(r)))return Promise.resolve({success:!1,key:"form__amount_invalid",params:{0:"stas"}});var a=i.tags.find((function(e){return"payment_hash"===e.tagName}));if(null!=a&&a.data)try{var c=yield this.getClient();if((yield c.specialInvoice(s,a.data)).is_paid)throw new P.InvoiceAlreadPaid}catch(l){var f=l.key,d=void 0===f?"":f;if("msg__invoice_is_already_paid"===d||"msg__authentication_failed_verify_again"===d)return Promise.resolve({success:!1,key:d})}return Promise.resolve({success:!0})}));return function(t){return e.apply(this,arguments)}}(),r.fetchSpecialInvoice=function(){var e=f()((function*(e){var t=yield this.getCurrentBalanceAddress(),n=yield this.getClient();return yield n.specialInvoice(t,e)}));return function(t){return e.apply(this,arguments)}}(),r.checkAuth=function(){var e=f()((function*(){var e=yield this.getCurrentBalanceAddress();return(yield this.getClient()).checkAuth(e)}));return function(){return e.apply(this,arguments)}}(),r.isZeroAmountInvoice=function(e){return e.millisatoshis&&+e.millisatoshis<=0||e.satoshis&&+e.satoshis<=0||!e.millisatoshis&&!e.satoshis},l()(n)}(L.VaultBase)}}]);