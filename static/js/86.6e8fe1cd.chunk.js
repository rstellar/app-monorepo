(this.webpackJsonp=this.webpackJsonp||[]).push([[86],{4081:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"GasPanelRoutes",(function(){return r})),function(e){e.GasPanelModal="GasPanelModal"}(r||(r={}))},5321:function(e,t,n){"use strict";n.r(t);var r,o,c=n(50),i=n(57),s=n(49),l=n(75),a=n(38),u=n(358),d=n(2),f=n.n(d),b=n(4),p=n.n(b),j=n(1),O=n(42),y=n(89),g=n(35),m=n(17),v=n(24),h=n(192),w=n(86),x=[g.OnekeyNetwork.btc,g.OnekeyNetwork.eth,g.OnekeyNetwork.polygon],k=((r={})[g.OnekeyNetwork.btc]={supportOverview:!1,EIP1559Enabled:!1},r[g.OnekeyNetwork.eth]={supportOverview:!0,EIP1559Enabled:!0},r[g.OnekeyNetwork.polygon]={supportOverview:!0,EIP1559Enabled:!0},r),P=((o={})[g.OnekeyNetwork.eth]={low:0,stable:100,busy:200},o[g.OnekeyNetwork.polygon]={low:0,stable:200,busy:300},o),I=n(11),S=n(1104),E=n(56),N=n(3),_=n.n(N),M=n(15),C=n.n(M),D=n(20),F=n(21),T=n.n(F),B=n(611),G=n(1545),A=n(939),R=n(0),z=["selectedNetworkId","gasInfo","isEIP1559Enabled"];function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={marginTop:4,paddingLeft:"0px",paddingRight:"0px",paddingTop:"4px",paddingBottom:"4px",alignItems:"center",height:"48px",bgColor:"transparent"},V=["decorative-icon-three","text-warning","text-success"];function W(e){var t=e.index,n=e.price,r=e.feeInfo,o=Object(j.useMemo)((function(){var e,t;return r.isBtcForkChain?""+new T.a(n).shiftedBy(null!=(t=null==r?void 0:r.feeDecimals)?t:8).toFixed():"string"===typeof n?n:null!=(e=n.gasPrice)?e:n.price}),[null==r?void 0:r.feeDecimals,r.isBtcForkChain,n]),c=Object(j.useMemo)((function(){return r.isBtcForkChain?"sat/vB":r.feeSymbol}),[r.feeSymbol,r.isBtcForkChain]);return Object(R.jsx)(D.default,{typography:"Body1Strong",color:V[t],children:(null!=o?o:"")+" "+(null!=c?c:"")})}function q(e,t){return t?e:"object"===typeof e?null!=(n=e.gasPrice)?n:e.price:e;var n}function H(e){var t=e.selectedNetworkId,n=e.gasInfo,r=e.isEIP1559Enabled,o=C()(e,z),c=(n||{}).prices,i=m.default.serviceGas,u=Object(j.useState)([]),d=p()(u,2),b=d[0],O=d[1],y=Object(v.useNetworkSimple)(t),h=(null==y?void 0:y.settings.isFeeRateMode)||(null==y?void 0:y.settings.isBtcForkChain),w=Object(j.useMemo)((function(){var e;if(!c||!y)return[];var n=String(null!=(e=null==y?void 0:y.settings.minGasLimit)?e:21e3),o={prices:c,defaultPresetIndex:"1",eip1559:r&&!h,limit:n=h?"340":n,feeSymbol:y.feeSymbol,feeDecimals:y.feeDecimals,nativeDecimals:y.decimals,isBtcForkChain:h,feeList:h?c.map((function(e){return new T.a(e).times(n).shiftedBy(y.decimals).toNumber()})).filter(Boolean):[]};return c.map((function(e,i){return U({value:i.toString(),title:Object(R.jsx)(B.FeeSpeedLabel,{index:i,iconSize:28,space:3,prices:c,waitingSeconds:b[i],withSpeedTime:!0}),describe:Object(R.jsxs)(a.default,{space:"10px",alignItems:"center",children:[Object(R.jsxs)(E.default,{children:[Object(R.jsx)(W,{price:e,index:i,feeInfo:o}),Object(R.jsx)(A.SendEditFeeOverview,{accountId:"",networkId:t,price:q(e,r&&!h),feeInfo:o,limit:n,currencyProps:{typography:"Body2",textAlign:"right",color:"text-subdued"},formatOptions:{fixed:t===g.OnekeyNetwork.polygon?4:2},onlyCurrency:!0})]}),Object(R.jsx)(G.FeeSpeedTip,{index:i,isEIP1559:r&&!h,price:q(e,r&&!h),limit:n,feeInfo:o})]})},J)}))}),[h,r,y,c,t,b]);return Object(j.useEffect)((function(){(function(){var e=f()((function*(){var e=yield i.getTxWaitingSeconds({networkId:t});O(e)}));return function(){return e.apply(this,arguments)}})()()}),[t,i]),Object(R.jsx)(I.default,U(U({},o),{},{children:n?Object(R.jsx)(S.default,{mt:2,padding:"0px",items:w,name:"standard fee group"}):Object(R.jsx)(s.default,{w:"full",py:16,children:Object(R.jsx)(l.default,{size:"lg"})})}))}var K,Q=n(2442),X=["gasInfo","selectedNetworkId","isEIP1559Enabled"];function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.low="low",e.stable="stable",e.busy="busy"}(K||(K={}));var $=["\ud83c\udf43","\u2615\ufe0f","\ud83d\udd25"];function ee(e){var t,n,r=e.gasInfo,o=e.selectedNetworkId,c=e.isEIP1559Enabled,i=C()(e,X),s=r||{},l=s.estimatedTransactionCount,u=s.networkCongestion,d=s.prices,f=Object(y.default)(),b=Object(v.useNetworkSimple)(o);if(!r)return null;if(void 0===u&&void 0===l)return null;var p=null==d?void 0:d[0],j=K.stable;u?j=function(e){return e<Q.NetworkCongestionThresholds.stable?K.low:e>=Q.NetworkCongestionThresholds.stable&&e<Q.NetworkCongestionThresholds.busy?K.stable:K.busy}(u):l&&(j=function(e){var t=e.estimatedTransactionCount,n=e.networkId;return t<P[n].stable?K.low:t>=P[n].stable&&t<P[n].busy?K.stable:K.busy}({estimatedTransactionCount:l,networkId:o}));var O=function(e){switch(e){case K.low:return{label:$[0]};case K.stable:return{label:$[1]};case K.busy:return{label:$[2]};default:return{label:$[1]}}}(j);return Object(R.jsxs)(I.default,Z(Z({},i),{},{children:[Object(R.jsx)(D.default,{fontSize:56,textAlign:"center",children:O.label}),Object(R.jsx)(D.default,{typography:"DisplayMedium",textAlign:"center",children:f.formatMessage({id:"title__current_gas_fee"})}),c?Object(R.jsx)(a.default,{alignItems:"center",mt:1,justifyContent:"center",children:Object(R.jsx)(D.default,{color:"text-subdued",children:f.formatMessage({id:"form__base_fee"})+": "+new T.a(null!=(t=null==p?void 0:p.baseFee)?t:0).toFixed(2)+" "+(null!=(n=null==b?void 0:b.feeSymbol)?n:"")})}):Object(R.jsx)(D.default,{typography:"Body2",mt:1,color:"text-subdued",textAlign:"center",children:f.formatMessage({id:"title__current_gas_fee_desc"},{0:(null==b?void 0:b.symbol)||""})})]}))}var te=n(100),ne=["leftSeconds","setLeftSeconds","fetchGasInfo"];function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=null,ie=function(e){return Object(R.jsx)(D.default,{color:"text-success",children:e})};function se(e){var t=e.leftSeconds,n=e.setLeftSeconds,r=e.fetchGasInfo,o=C()(e,ne),c=Object(y.default)();return Object(j.useEffect)((function(){return 6===t&&ce&&clearTimeout(ce),ce=setInterval((function(){var e=t-1;e<0&&(e=0,r()),n(e)}),1e3),function(){ce&&clearTimeout(ce)}}),[r,t,n]),Object(R.jsxs)(I.default,oe(oe({},o),{},{children:[Object(R.jsx)(te.default,{}),Object(R.jsx)(D.default,{color:"text-subdued",textAlign:"center",mt:4,children:c.formatMessage({id:"content__gas_fee_will_automatically_update_after_str"},{0:c.formatMessage({id:"content__str_seconds_plural"},{0:t}),a:ie})})]}))}var le=n(642),ae=n(60),ue=n(40),de=n(123);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e){var t=e.selectedNetworkId,n=e.setSelectedNetworkId,r=Object(v.useManageNetworks)().allNetworks,o=Object(j.useMemo)((function(){return r.filter((function(e){return x.includes(e.id)}))}),[r]),c=Object(v.useNetworkSimple)(t),i=Object(j.useMemo)((function(){return{label:null==c?void 0:c.name,value:null==c?void 0:c.id,tokenProps:{token:{logoURI:null==c?void 0:c.logoURI,name:null==c?void 0:c.shortName}},badge:"evm"===(null==c?void 0:c.impl)?"EVM":void 0}}),[null==c?void 0:c.id,null==c?void 0:c.impl,null==c?void 0:c.logoURI,null==c?void 0:c.name,null==c?void 0:c.shortName]);return Object(R.jsx)(le.default,{w:"190",trigger:function(e){return Object(R.jsx)(ae.default,be(be({accessibilityLabel:"More options menu"},e),{},{children:Object(R.jsxs)(a.default,{alignItems:"center",space:3,children:[Object(R.jsx)(de.default,be({size:6},i.tokenProps)),Object(R.jsx)(D.default,{typography:"Body1",children:null==c?void 0:c.name}),Object(R.jsx)(ue.default,{size:20,name:"ChevronDownMini",color:"icon-subdued"})]})}))},children:o.map((function(e){return Object(R.jsx)(le.default.Item,{onPress:function(){return n(e.id)},children:Object(R.jsxs)(a.default,{space:4,alignItems:"center",children:[Object(R.jsx)(I.default,{width:"20px",children:t===e.id&&Object(R.jsx)(ue.default,{name:"CheckMini",size:20,color:"interactive-default"})}),Object(R.jsx)(D.default,{typography:"Body1",children:e.name})]})},e.id)}))})}var je=g.OnekeyNetwork.eth;var Oe=n(4081),ye=n(238),ge=Object(ye.default)(),me=[{name:Oe.GasPanelRoutes.GasPanelModal,component:function(){var e,t=Object(y.default)(),n=Object(O.useRoute)(),r=Object(j.useRef)(""),o=n.params.networkId,c=void 0===o?"":o,d=Object(h.appSelector)((function(e){return e.settings})).selectedFiatMoneySymbol,b=Object(j.useState)(x.includes(c)?c:je),g=p()(b,2),P=g[0],I=g[1],S=Object(j.useState)(!1),E=p()(S,2),N=E[0],_=E[1],M=Object(j.useState)(null),C=p()(M,2),D=C[0],F=C[1],T=Object(j.useState)(6),B=p()(T,2),G=B[0],A=B[1],z=Object(v.useSettings)(),L=Object(v.useNativeToken)(P),U=m.default.serviceGas,J=Object(j.useMemo)((function(){return!(!D||!D.prices[0])&&("object"===typeof D.prices[0]&&"maxFeePerGas"in D.prices[0]&&"maxPriorityFeePerGas"in D.prices[0])}),[D]),V=null==(e=null==z?void 0:z.gasPanelEIP1559Enabled)||e,W=Object(j.useCallback)((function(e){m.default.dispatch(Object(w.setGasPanelEIP1559Enabled)(e))}),[]),q=Object(j.useCallback)(f()((function*(){var e=Math.random().toString();r.current=e;var t=yield U.getGasInfo({networkId:P});5===t.prices.length&&(t.prices=[t.prices[0],t.prices[2],t.prices[4]]),e===r.current&&(F(t),_(!0),A(6))})),[P,U]);return Object(j.useEffect)((function(){F(null),q()}),[q,P,U]),Object(j.useEffect)((function(){c&&x.includes(c)&&I(c)}),[c]),Object(j.useEffect)((function(){var e;m.default.servicePrice.fetchSimpleTokenPrice({networkId:P,tokenIds:[null!=(e=null==L?void 0:L.tokenIdOnNetwork)?e:""],vsCurrency:d})}),[c,d,P,null==L?void 0:L.tokenIdOnNetwork]),Object(R.jsx)(i.default,{header:t.formatMessage({id:"content__gas_fee"}),height:"560px",hideSecondaryAction:!0,onPrimaryActionPress:function(e){return(0,e.close)()},primaryActionProps:{type:"primary"},primaryActionTranslationId:"action__i_got_it",scrollViewProps:{children:N?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsxs)(a.default,{justifyContent:"space-between",alignItems:"center",children:[Object(R.jsx)(pe,{selectedNetworkId:P,setSelectedNetworkId:I}),J&&k[P].EIP1559Enabled?Object(R.jsx)(u.default,{onToggle:function(){W(!V)},isChecked:V,label:"EIP 1559",size:"mini"}):null]}),k[P].supportOverview?Object(R.jsx)(ee,{mt:8,gasInfo:D,isEIP1559Enabled:V,selectedNetworkId:P}):null,Object(R.jsx)(H,{mt:6,gasInfo:D,isEIP1559Enabled:V,selectedNetworkId:P}),D?Object(R.jsx)(se,{mt:12,leftSeconds:G,setLeftSeconds:A,fetchGasInfo:q}):null]}):Object(R.jsx)(s.default,{w:"full",py:10,children:Object(R.jsx)(l.default,{size:"lg"})})}})}}];t.default=function(){var e=Object(c.default)();return Object(R.jsx)(ge.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:me.map((function(e){return Object(R.jsx)(ge.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);